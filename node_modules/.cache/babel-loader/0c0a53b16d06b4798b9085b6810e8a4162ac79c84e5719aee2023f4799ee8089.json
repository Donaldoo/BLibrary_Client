{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/User/Desktop/LibraryClient/booklibrary/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/User/Desktop/LibraryClient/booklibrary/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/User/Desktop/LibraryClient/booklibrary/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from\"react\";import inputHelper from\"../Helper/inputHelper\";import{useLoginUserMutation}from\"../Apis/authApi\";import jwt_decode from\"jwt-decode\";import{useDispatch}from\"react-redux\";import{setLoggedInUser}from\"../Storage/Redux/userAuthSlice\";import{useNavigate}from\"react-router-dom\";import MainLoader from\"../Components/Common/MainLoader\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Login(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var dispatch=useDispatch();var navigate=useNavigate();var _useLoginUserMutation=useLoginUserMutation(),_useLoginUserMutation2=_slicedToArray(_useLoginUserMutation,1),loginUser=_useLoginUserMutation2[0];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=useState({email:\"\",password:\"\"}),_useState6=_slicedToArray(_useState5,2),userInput=_useState6[0],setUserInput=_useState6[1];var handleUserInput=function handleUserInput(e){var tempData=inputHelper(e,userInput);setUserInput(tempData);};var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var response,token,_jwt_decode,fullName,email,id,role;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();setLoading(true);_context.next=4;return loginUser({email:userInput.email,password:userInput.password});case 4:response=_context.sent;if(response.data){token=response.data.result.token;_jwt_decode=jwt_decode(token),fullName=_jwt_decode.fullName,email=_jwt_decode.email,id=_jwt_decode.id,role=_jwt_decode.role;localStorage.setItem(\"token\",token);dispatch(setLoggedInUser({fullName:fullName,email:email,id:id,role:role}));navigate(\"/\");}else if(response.error){console.log(response.error.data.errorMessages[0]);setError(response.error.data.errorMessages[0]);}setLoading(false);case 7:case\"end\":return _context.stop();}},_callee);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"container text-center\",children:[loading&&/*#__PURE__*/_jsx(MainLoader,{}),/*#__PURE__*/_jsxs(\"form\",{method:\"post\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"h1\",{className:\"mt-5\",children:\"Login\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-sm-6 offset-sm-3 col-xs-12 mt-4\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",placeholder:\"Enter Username\",required:true,name:\"email\",value:userInput.email,onChange:handleUserInput})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-sm-6 offset-sm-3 col-xs-12 mt-4\",children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-control\",placeholder:\"Enter Password\",required:true,name:\"password\",value:userInput.password,onChange:handleUserInput})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4\",children:[error&&/*#__PURE__*/_jsx(\"p\",{className:\"text-danger\",children:error}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-success\",style:{width:\"200px\"},children:\"Login\"})]})]})]});}export default Login;","map":{"version":3,"names":["React","useState","inputHelper","useLoginUserMutation","jwt_decode","useDispatch","setLoggedInUser","useNavigate","MainLoader","jsx","_jsx","jsxs","_jsxs","Login","_useState","_useState2","_slicedToArray","error","setError","dispatch","navigate","_useLoginUserMutation","_useLoginUserMutation2","loginUser","_useState3","_useState4","loading","setLoading","_useState5","email","password","_useState6","userInput","setUserInput","handleUserInput","e","tempData","handleSubmit","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","token","_jwt_decode","fullName","id","role","wrap","_callee$","_context","prev","next","preventDefault","sent","data","result","localStorage","setItem","console","log","errorMessages","stop","_x","apply","arguments","className","children","method","onSubmit","type","placeholder","required","name","value","onChange","style","width"],"sources":["C:/Users/User/Desktop/LibraryClient/booklibrary/src/Pages/Login.tsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport inputHelper from \"../Helper/inputHelper\";\r\nimport { apiResponse, userModel } from \"../Interfaces\";\r\nimport { useLoginUserMutation } from \"../Apis/authApi\";\r\nimport jwt_decode from \"jwt-decode\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { setLoggedInUser } from \"../Storage/Redux/userAuthSlice\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport MainLoader from \"../Components/Common/MainLoader\";\r\n\r\nfunction Login() {\r\n  const [error, setError] = useState(\"\");\r\n  const dispatch = useDispatch();\r\n  const navigate = useNavigate();\r\n  const [loginUser] = useLoginUserMutation();\r\n  const [loading, setLoading] = useState(false);\r\n  const [userInput, setUserInput] = useState({\r\n    email: \"\",\r\n    password: \"\",\r\n  });\r\n\r\n  const handleUserInput = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const tempData = inputHelper(e, userInput);\r\n    setUserInput(tempData);\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n\r\n    const response: apiResponse = await loginUser({\r\n      email: userInput.email,\r\n      password: userInput.password,\r\n    });\r\n\r\n    if (response.data) {\r\n      const { token } = response.data.result;\r\n      const { fullName, email, id, role }: userModel = jwt_decode(token);\r\n      localStorage.setItem(\"token\", token);\r\n      dispatch(setLoggedInUser({ fullName, email, id, role }));\r\n      navigate(\"/\");\r\n    } else if (response.error) {\r\n      console.log(response.error.data.errorMessages[0]);\r\n      setError(response.error.data.errorMessages[0]);\r\n    }\r\n\r\n    setLoading(false);\r\n  };\r\n\r\n  return (\r\n    <div className=\"container text-center\">\r\n      {loading && <MainLoader />}\r\n      <form method=\"post\" onSubmit={handleSubmit}>\r\n        <h1 className=\"mt-5\">Login</h1>\r\n        <div className=\"mt-5\">\r\n          <div className=\"col-sm-6 offset-sm-3 col-xs-12 mt-4\">\r\n            <input\r\n              type=\"text\"\r\n              className=\"form-control\"\r\n              placeholder=\"Enter Username\"\r\n              required\r\n              name=\"email\"\r\n              value={userInput.email}\r\n              onChange={handleUserInput}\r\n            />\r\n          </div>\r\n\r\n          <div className=\"col-sm-6 offset-sm-3 col-xs-12 mt-4\">\r\n            <input\r\n              type=\"password\"\r\n              className=\"form-control\"\r\n              placeholder=\"Enter Password\"\r\n              required\r\n              name=\"password\"\r\n              value={userInput.password}\r\n              onChange={handleUserInput}\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"mt-4\">\r\n          {error && <p className=\"text-danger\">{error}</p>}\r\n          <button\r\n            type=\"submit\"\r\n            className=\"btn btn-success\"\r\n            style={{ width: \"200px\" }}\r\n          >\r\n            Login\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Login;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}