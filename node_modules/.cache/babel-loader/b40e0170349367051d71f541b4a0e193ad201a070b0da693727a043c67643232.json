{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/User/Desktop/LibraryClient/booklibrary/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"C:/Users/User/Desktop/LibraryClient/booklibrary/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/Users/User/Desktop/LibraryClient/booklibrary/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/User/Desktop/LibraryClient/booklibrary/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import inputHelper from\"../../Helper/inputHelper\";import{useNavigate,useParams}from\"react-router-dom\";import{useCreateCategoryMutation,useGetCategoryByIdQuery,useUpdateCategoryMutation}from\"../../Apis/categoryApi\";import{useSelector}from\"react-redux\";import toastNotify from\"../../Helper/toastNotify\";import withAdminAuth from\"../../HOC/withAdminAuth\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var categoryData={name:\"\",priority:\"\",createdBy:\"\"};function CategoryUpsert(){var _useParams=useParams(),id=_useParams.id;var navigate=useNavigate();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(categoryData),_useState4=_slicedToArray(_useState3,2),categoryInputs=_useState4[0],setCategoryInputs=_useState4[1];var _useCreateCategoryMut=useCreateCategoryMutation(),_useCreateCategoryMut2=_slicedToArray(_useCreateCategoryMut,1),createCategory=_useCreateCategoryMut2[0];var _useUpdateCategoryMut=useUpdateCategoryMutation(),_useUpdateCategoryMut2=_slicedToArray(_useUpdateCategoryMut,1),updateCategory=_useUpdateCategoryMut2[0];var userData=useSelector(function(state){return state.userAuthStore;});var _useGetCategoryByIdQu=useGetCategoryByIdQuery(id),data=_useGetCategoryByIdQu.data;useEffect(function(){if(data&&data.result){var tempData={name:data.result.name,priority:data.result.priority,createdBy:userData.fullName||\"null\"};setCategoryInputs(tempData);}},[data]);var handleCategoryInput=function handleCategoryInput(e){var tempData=inputHelper(e,categoryInputs);setCategoryInputs(tempData);};var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var payload,response,updatedPayload,obj,_response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();setLoading(true);payload={name:categoryInputs.name,priority:categoryInputs.priority,createdBy:userData.fullName};console.log(payload);if(!id){_context.next=14;break;}//update\nupdatedPayload=_objectSpread(_objectSpread({},payload),{},{id:id});obj={data:updatedPayload,id:id};console.log(obj);_context.next=10;return updateCategory(obj);case 10:response=_context.sent;toastNotify(\"Category updated successfully!\");_context.next=18;break;case 14:_context.next=16;return createCategory(payload);case 16:_response=_context.sent;toastNotify(\"Category created successfully\",\"success\");case 18:if(response){setLoading(false);navigate(\"/crud/listCategories\");}setLoading(false);case 20:case\"end\":return _context.stop();}},_callee);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"container border mt-5 p-5\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"px-2 text-success\",children:id?\"Edit category\":\"Add category\"}),/*#__PURE__*/_jsx(\"form\",{method:\"post\",onSubmit:handleSubmit,children:/*#__PURE__*/_jsx(\"div\",{className:\"row mt-3\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-7 offset-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",placeholder:\"Enter Name\",name:\"name\",value:categoryInputs.name,onChange:handleCategoryInput}),/*#__PURE__*/_jsx(\"input\",{className:\"form-control mt-3\",placeholder:\"Enter priority\",name:\"priority\",value:categoryInputs.priority,onChange:handleCategoryInput}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-8\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",style:{width:\"50%\"},className:\"btn btn-success form-control mt-5\",children:id?\"update\":\"Create\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-4\",children:/*#__PURE__*/_jsx(\"a\",{onClick:function onClick(){return navigate(\"/crud/listCategories\");},className:\"btn btn-secondary form-control mt-5\",children:\"Back to list\"})})]})]})})})]});}export default withAdminAuth(CategoryUpsert);","map":{"version":3,"names":["React","useState","useEffect","inputHelper","useNavigate","useParams","useCreateCategoryMutation","useGetCategoryByIdQuery","useUpdateCategoryMutation","useSelector","toastNotify","withAdminAuth","jsx","_jsx","jsxs","_jsxs","categoryData","name","priority","createdBy","CategoryUpsert","_useParams","id","navigate","_useState","_useState2","_slicedToArray","loading","setLoading","_useState3","_useState4","categoryInputs","setCategoryInputs","_useCreateCategoryMut","_useCreateCategoryMut2","createCategory","_useUpdateCategoryMut","_useUpdateCategoryMut2","updateCategory","userData","state","userAuthStore","_useGetCategoryByIdQu","data","result","tempData","fullName","handleCategoryInput","e","handleSubmit","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","payload","response","updatedPayload","obj","_response","wrap","_callee$","_context","prev","next","preventDefault","console","log","_objectSpread","sent","stop","_x","apply","arguments","className","children","method","onSubmit","type","placeholder","value","onChange","style","width","onClick"],"sources":["C:/Users/User/Desktop/LibraryClient/booklibrary/src/Pages/CRUD/CategoryUpsert.tsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport inputHelper from \"../../Helper/inputHelper\";\r\n\r\nimport { useNavigate, useParams } from \"react-router-dom\";\r\nimport {\r\n  useCreateCategoryMutation,\r\n  useGetCategoryByIdQuery,\r\n  useUpdateCategoryMutation,\r\n} from \"../../Apis/categoryApi\";\r\nimport { userModel } from \"../../Interfaces\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { RootState } from \"../../Storage/Redux/store\";\r\nimport toastNotify from \"../../Helper/toastNotify\";\r\nimport withAdminAuth from \"../../HOC/withAdminAuth\";\r\n\r\nconst categoryData = {\r\n  name: \"\",\r\n  priority: \"\",\r\n  createdBy: \"\",\r\n};\r\n\r\nfunction CategoryUpsert() {\r\n  const { id } = useParams();\r\n\r\n  const navigate = useNavigate();\r\n  const [loading, setLoading] = useState(false);\r\n  const [categoryInputs, setCategoryInputs] = useState(categoryData);\r\n  const [createCategory] = useCreateCategoryMutation();\r\n  const [updateCategory] = useUpdateCategoryMutation();\r\n\r\n  const userData: userModel = useSelector(\r\n    (state: RootState) => state.userAuthStore\r\n  );\r\n  \r\n  const { data } = useGetCategoryByIdQuery(id);\r\n  useEffect(()=> {\r\n    if(data && data.result) {\r\n      const tempData = {\r\n        name: data.result.name,\r\n        priority: data.result.priority,\r\n        createdBy: userData.fullName || \"null\",\r\n      };\r\n      setCategoryInputs(tempData);\r\n    }\r\n  },[data])\r\n\r\n  const handleCategoryInput = (\r\n    e: React.ChangeEvent<\r\n      HTMLInputElement\r\n    >\r\n  ) => {\r\n    const tempData = inputHelper(e, categoryInputs);\r\n    setCategoryInputs(tempData);\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n\r\n    const payload = {\r\n      name: categoryInputs.name,\r\n      priority: categoryInputs.priority,\r\n      createdBy: userData.fullName,\r\n    };\r\n\r\n    console.log(payload);\r\n\r\n    let response;\r\n    if(id){\r\n      //update\r\n      const updatedPayload = {...payload, id};\r\n      const obj = {data: updatedPayload, id}\r\n      console.log(obj)\r\n      response = await updateCategory(obj)\r\n      toastNotify(\"Category updated successfully!\")\r\n    } else {\r\n      //create\r\n      const response = await createCategory(payload);\r\n      toastNotify(\"Category created successfully\", \"success\")\r\n    }\r\n\r\n\r\n    \r\n    if (response) {\r\n      setLoading(false);\r\n      navigate(\"/crud/listCategories\");\r\n    }\r\n\r\n    setLoading(false);\r\n  };\r\n\r\n  return (\r\n    <div className=\"container border mt-5 p-5\">\r\n      <h3 className=\"px-2 text-success\">\r\n        {id ? \"Edit category\" : \"Add category\"}\r\n      </h3>\r\n      <form method=\"post\" onSubmit={handleSubmit}>\r\n        <div className=\"row mt-3\">\r\n          <div className=\"col-md-7 offset-2\">\r\n            <input\r\n              type=\"text\"\r\n              className=\"form-control\"\r\n              placeholder=\"Enter Name\"\r\n              name=\"name\"\r\n              value={categoryInputs.name}\r\n              onChange={handleCategoryInput}\r\n            />\r\n            <input\r\n              className=\"form-control mt-3\"\r\n              placeholder=\"Enter priority\"\r\n              name=\"priority\"\r\n              value={categoryInputs.priority}\r\n              onChange={handleCategoryInput}\r\n            ></input>\r\n\r\n            <div className=\"row\">\r\n              <div className=\"col-8\">\r\n                <button\r\n                  type=\"submit\"\r\n                  style={{ width: \"50%\" }}\r\n                  className=\"btn btn-success form-control mt-5\"\r\n\r\n                >\r\n                  {id ? \"update\" : \"Create\"}\r\n                </button>\r\n              </div>\r\n              <div className=\"col-4\">\r\n                <a\r\n                  onClick={() => navigate(\"/crud/listCategories\")}\r\n                  className=\"btn btn-secondary form-control mt-5\"\r\n                >\r\n                  Back to list\r\n                </a>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default withAdminAuth(CategoryUpsert);\r\n"],"mappings":"miBAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,MAAO,CAAAC,WAAW,KAAM,0BAA0B,CAElD,OAASC,WAAW,CAAEC,SAAS,KAAQ,kBAAkB,CACzD,OACEC,yBAAyB,CACzBC,uBAAuB,CACvBC,yBAAyB,KACpB,wBAAwB,CAE/B,OAASC,WAAW,KAAQ,aAAa,CAEzC,MAAO,CAAAC,WAAW,KAAM,0BAA0B,CAClD,MAAO,CAAAC,aAAa,KAAM,yBAAyB,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAEpD,GAAM,CAAAC,YAAY,CAAG,CACnBC,IAAI,CAAE,EAAE,CACRC,QAAQ,CAAE,EAAE,CACZC,SAAS,CAAE,EACb,CAAC,CAED,QAAS,CAAAC,cAAcA,CAAA,CAAG,CACxB,IAAAC,UAAA,CAAehB,SAAS,EAAE,CAAlBiB,EAAE,CAAAD,UAAA,CAAFC,EAAE,CAEV,GAAM,CAAAC,QAAQ,CAAGnB,WAAW,EAAE,CAC9B,IAAAoB,SAAA,CAA8BvB,QAAQ,CAAC,KAAK,CAAC,CAAAwB,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAAtCG,OAAO,CAAAF,UAAA,IAAEG,UAAU,CAAAH,UAAA,IAC1B,IAAAI,UAAA,CAA4C5B,QAAQ,CAACe,YAAY,CAAC,CAAAc,UAAA,CAAAJ,cAAA,CAAAG,UAAA,IAA3DE,cAAc,CAAAD,UAAA,IAAEE,iBAAiB,CAAAF,UAAA,IACxC,IAAAG,qBAAA,CAAyB3B,yBAAyB,EAAE,CAAA4B,sBAAA,CAAAR,cAAA,CAAAO,qBAAA,IAA7CE,cAAc,CAAAD,sBAAA,IACrB,IAAAE,qBAAA,CAAyB5B,yBAAyB,EAAE,CAAA6B,sBAAA,CAAAX,cAAA,CAAAU,qBAAA,IAA7CE,cAAc,CAAAD,sBAAA,IAErB,GAAM,CAAAE,QAAmB,CAAG9B,WAAW,CACrC,SAAC+B,KAAgB,QAAK,CAAAA,KAAK,CAACC,aAAa,GAC1C,CAED,IAAAC,qBAAA,CAAiBnC,uBAAuB,CAACe,EAAE,CAAC,CAApCqB,IAAI,CAAAD,qBAAA,CAAJC,IAAI,CACZzC,SAAS,CAAC,UAAK,CACb,GAAGyC,IAAI,EAAIA,IAAI,CAACC,MAAM,CAAE,CACtB,GAAM,CAAAC,QAAQ,CAAG,CACf5B,IAAI,CAAE0B,IAAI,CAACC,MAAM,CAAC3B,IAAI,CACtBC,QAAQ,CAAEyB,IAAI,CAACC,MAAM,CAAC1B,QAAQ,CAC9BC,SAAS,CAAEoB,QAAQ,CAACO,QAAQ,EAAI,MAClC,CAAC,CACDd,iBAAiB,CAACa,QAAQ,CAAC,CAC7B,CACF,CAAC,CAAC,CAACF,IAAI,CAAC,CAAC,CAET,GAAM,CAAAI,mBAAmB,CAAG,QAAtB,CAAAA,mBAAmBA,CACvBC,CAEC,CACE,CACH,GAAM,CAAAH,QAAQ,CAAG1C,WAAW,CAAC6C,CAAC,CAAEjB,cAAc,CAAC,CAC/CC,iBAAiB,CAACa,QAAQ,CAAC,CAC7B,CAAC,CAED,GAAM,CAAAI,YAAY,6BAAAC,IAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QAAON,CAAmC,MAAAO,OAAA,CAAAC,QAAA,CAAAC,cAAA,CAAAC,GAAA,CAAAC,SAAA,QAAAP,mBAAA,GAAAQ,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SAC7DhB,CAAC,CAACiB,cAAc,EAAE,CAClBrC,UAAU,CAAC,IAAI,CAAC,CAEV2B,OAAO,CAAG,CACdtC,IAAI,CAAEc,cAAc,CAACd,IAAI,CACzBC,QAAQ,CAAEa,cAAc,CAACb,QAAQ,CACjCC,SAAS,CAAEoB,QAAQ,CAACO,QACtB,CAAC,CAEDoB,OAAO,CAACC,GAAG,CAACZ,OAAO,CAAC,CAAC,IAGlBjC,EAAE,EAAAwC,QAAA,CAAAE,IAAA,WACH;AACMP,cAAc,CAAAW,aAAA,CAAAA,aAAA,IAAOb,OAAO,MAAEjC,EAAE,CAAFA,EAAE,GAChCoC,GAAG,CAAG,CAACf,IAAI,CAAEc,cAAc,CAAEnC,EAAE,CAAFA,EAAE,CAAC,CACtC4C,OAAO,CAACC,GAAG,CAACT,GAAG,CAAC,CAAAI,QAAA,CAAAE,IAAA,UACC,CAAA1B,cAAc,CAACoB,GAAG,CAAC,SAApCF,QAAQ,CAAAM,QAAA,CAAAO,IAAA,CACR3D,WAAW,CAAC,gCAAgC,CAAC,CAAAoD,QAAA,CAAAE,IAAA,kBAAAF,QAAA,CAAAE,IAAA,UAGtB,CAAA7B,cAAc,CAACoB,OAAO,CAAC,SAAxCC,SAAQ,CAAAM,QAAA,CAAAO,IAAA,CACd3D,WAAW,CAAC,+BAA+B,CAAE,SAAS,CAAC,SAKzD,GAAI8C,QAAQ,CAAE,CACZ5B,UAAU,CAAC,KAAK,CAAC,CACjBL,QAAQ,CAAC,sBAAsB,CAAC,CAClC,CAEAK,UAAU,CAAC,KAAK,CAAC,CAAC,yBAAAkC,QAAA,CAAAQ,IAAA,MAAAhB,OAAA,GACnB,kBAlCK,CAAAL,YAAYA,CAAAsB,EAAA,SAAArB,IAAA,CAAAsB,KAAA,MAAAC,SAAA,OAkCjB,CAED,mBACE1D,KAAA,QAAK2D,SAAS,CAAC,2BAA2B,CAAAC,QAAA,eACxC9D,IAAA,OAAI6D,SAAS,CAAC,mBAAmB,CAAAC,QAAA,CAC9BrD,EAAE,CAAG,eAAe,CAAG,cAAc,EACnC,cACLT,IAAA,SAAM+D,MAAM,CAAC,MAAM,CAACC,QAAQ,CAAE5B,YAAa,CAAA0B,QAAA,cACzC9D,IAAA,QAAK6D,SAAS,CAAC,UAAU,CAAAC,QAAA,cACvB5D,KAAA,QAAK2D,SAAS,CAAC,mBAAmB,CAAAC,QAAA,eAChC9D,IAAA,UACEiE,IAAI,CAAC,MAAM,CACXJ,SAAS,CAAC,cAAc,CACxBK,WAAW,CAAC,YAAY,CACxB9D,IAAI,CAAC,MAAM,CACX+D,KAAK,CAAEjD,cAAc,CAACd,IAAK,CAC3BgE,QAAQ,CAAElC,mBAAoB,EAC9B,cACFlC,IAAA,UACE6D,SAAS,CAAC,mBAAmB,CAC7BK,WAAW,CAAC,gBAAgB,CAC5B9D,IAAI,CAAC,UAAU,CACf+D,KAAK,CAAEjD,cAAc,CAACb,QAAS,CAC/B+D,QAAQ,CAAElC,mBAAoB,EACvB,cAEThC,KAAA,QAAK2D,SAAS,CAAC,KAAK,CAAAC,QAAA,eAClB9D,IAAA,QAAK6D,SAAS,CAAC,OAAO,CAAAC,QAAA,cACpB9D,IAAA,WACEiE,IAAI,CAAC,QAAQ,CACbI,KAAK,CAAE,CAAEC,KAAK,CAAE,KAAM,CAAE,CACxBT,SAAS,CAAC,mCAAmC,CAAAC,QAAA,CAG5CrD,EAAE,CAAG,QAAQ,CAAG,QAAQ,EAClB,EACL,cACNT,IAAA,QAAK6D,SAAS,CAAC,OAAO,CAAAC,QAAA,cACpB9D,IAAA,MACEuE,OAAO,CAAE,SAAAA,QAAA,QAAM,CAAA7D,QAAQ,CAAC,sBAAsB,CAAC,EAAC,CAChDmD,SAAS,CAAC,qCAAqC,CAAAC,QAAA,CAChD,cAED,EAAI,EACA,GACF,GACF,EACF,EACD,GACH,CAEV,CAEA,cAAe,CAAAhE,aAAa,CAACS,cAAc,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}